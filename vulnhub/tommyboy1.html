---
layout: default
---
<html>
<head>
    <title>Tommy Boy: 1 Walkthrough</title>
    <a href="https://pusher91.github.io/Hacking/">Return to Main Page</a>
</head>

<body>

    <h1>Tommy Boy: 1 Walkthrough</h1>

    <hr>

    <h2>Contents</h2>
    <ul>
        <li><a href="#summary">Summary</a></li>
        <li><a href="#portscan">Port Scanning</a></li>
        <li><a href="#infogather">Information Gathering</a></li>
        <li><a href="#foothold">Foothold</a></li>
        <li><a href="#root">Privesc - root</a></li>
    </ul>

    <h2><a id="summary">Summary</a></h2>

    <p></p>

    <h2><a id="portscan">Port Scanning</a></h2>

    <li>Running a port scan against the full port range to determine which ones are open.</li>

    <pre>
# Nmap 7.91 scan initiated Mon Sep 27 16:01:40 2021 as: nmap -p- -oN ping_tcp 10.0.0.22&#13;&#10;Nmap scan report for 10.0.0.22&#13;&#10;Host is up (0.0017s latency).&#13;&#10;Not shown: 65531 closed ports&#13;&#10;PORT      STATE SERVICE&#13;&#10;22/tcp    open  ssh&#13;&#10;80/tcp    open  http&#13;&#10;8008/tcp  open  http&#13;&#10;65534/tcp open  unknown&#13;&#10;MAC Address: 00:0C:29:6E:ED:CF (VMware)&#13;&#10;&#13;&#10;# Nmap done at Mon Sep 27 16:01:48 2021 -- 1 IP address (1 host up) scanned in 8.10 seconds
    </pre>

    <li>Running an nmap scan using the flags -sV and -sC to enumerate service versions and other information.</li>

    <pre>
# Nmap 7.91 scan initiated Mon Sep 27 16:02:01 2021 as: nmap -p22,80,8008,65534 -sV -sC -oN script_tcp 10.0.0.22&#13;&#10;Nmap scan report for 10.0.0.22&#13;&#10;Host is up (0.00030s latency).&#13;&#10;&#13;&#10;PORT      STATE SERVICE VERSION&#13;&#10;22/tcp    open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu1 (Ubuntu Linux; protocol 2.0)&#13;&#10;| ssh-hostkey: &#13;&#10;|   2048 a0:ca:62:ce:f6:7e:ae:8b:62:de:0b:db:21:3f:b0:d6 (RSA)&#13;&#10;|   256 46:6d:4b:4b:02:86:89:27:28:5c:1d:87:10:55:3d:59 (ECDSA)&#13;&#10;|_  256 56:9e:71:2a:a3:83:ff:63:11:7e:94:08:dd:28:1d:46 (ED25519)&#13;&#10;80/tcp    open  http    Apache httpd 2.4.18 ((Ubuntu))&#13;&#10;| http-robots.txt: 4 disallowed entries &#13;&#10;| /6packsofb...soda /lukeiamyourfather &#13;&#10;|_/lookalivelowbridge /flag-numero-uno.txt&#13;&#10;|_http-server-header: Apache/2.4.18 (Ubuntu)&#13;&#10;|_http-title: Welcome to Callahan Auto&#13;&#10;8008/tcp  open  http    Apache httpd 2.4.18 ((Ubuntu))&#13;&#10;|_http-server-header: Apache/2.4.18 (Ubuntu)&#13;&#10;|_http-title: KEEP OUT&#13;&#10;65534/tcp open  ftp     ProFTPD 1.2.10&#13;&#10;MAC Address: 00:0C:29:6E:ED:CF (VMware)&#13;&#10;Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel&#13;&#10;&#13;&#10;Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .&#13;&#10;# Nmap done at Mon Sep 27 16:02:36 2021 -- 1 IP address (1 host up) scanned in 35.70 seconds
    </pre>

    <br>
    <h2><a id="infogather">Information Gathering</a></h2>

    <li>I can't figure out the FTP creds so I start enumerating the web servers.  I begin with port 80.  Robots.txt gives me a flag and a few pictures.  But none of it seems to lead anywhere.  I then go back to the main page http://10.0.0.22 and look at the source code.  In the source code I find some comments that lead us to to the next step in gaining a foothold.</li>

    <pre>
&lt;!--Comment from Nick: backup copy is in Big Tom&apos;s home folder--&gt;&#13;&#10;&lt;!--Comment from Richard: can you give me access too? Big Tom&apos;s the only one w/password--&gt;&#13;&#10;&lt;!--Comment from Nick: Yeah yeah, my processor can only handle one command at a time--&gt;&#13;&#10;&lt;!--Comment from Richard: please, I&apos;ll ask nicely--&gt;&#13;&#10;&lt;!--Comment from Nick: I will set you up with admin access *if* you tell Tom to stop storing important information in the company blog--&gt;&#13;&#10;&lt;!--Comment from Richard: Deal.  Where&apos;s the blog again?--&gt;&#13;&#10;&lt;!--Comment from Nick: Seriously? You losers are hopeless. We hid it in a folder named after the place you noticed after you and Tom Jr. had your big fight. You know, where you cracked him over the head with a board. It&apos;s here if you don&apos;t remember: https://www.youtube.com/watch?v=VUxOd4CszJ8--&gt; &#13;&#10;&lt;!--Comment from Richard: Ah! How could I forget?  Thanks--&gt;
    </pre>

    <li>After watching the youtube link we can guess that the web directory we are looking for is "/prehistoricforest/.  http://10.0.0.22/prehistoricforest/ leads us to a wordpress page.  There is a password protected post on the wordpress page at this link, http://10.0.0.22/prehistoricforest/index.php/2016/07/06/status-of-restoring-company-home-page/,  and there is another post here, http://10.0.0.22/prehistoricforest/index.php/2016/07/06/status-of-restoring-company-home-page/, which tells us to go to /richard to find the password to the password protected wordpress post.  /richard leads us to a picture that we download and examine with exiftool.</li>

    <pre>
&boxdr;&HorizontalLine;&HorizontalLine;(kali&#12927;kali)-[~/Documents/VulnHub/TommyBoy_1/nmap]&#13;&#10;&boxur;&HorizontalLine;$ wget http://10.0.0.22/richard/shockedrichard.jpg                                                                                          &#13;&#10;--2021-09-27 18:38:09--  http://10.0.0.22/richard/shockedrichard.jpg&#13;&#10;Connecting to 10.0.0.22:80... connected.&#13;&#10;HTTP request sent, awaiting response... 200 OK&#13;&#10;Length: 167037 (163K) [image/jpeg]&#13;&#10;Saving to: &OpenCurlyQuote;shockedrichard.jpg&rsquor;&#13;&#10;&#13;&#10;shockedrichard.jpg                      100%[=============================================================================&gt;] 163.12K  --.-KB/s    in 0.001s  &#13;&#10;&#13;&#10;2021-09-27 18:38:09 (273 MB/s) - &OpenCurlyQuote;shockedrichard.jpg&rsquor; saved [167037/167037]&#13;&#10;&#13;&#10;                                                                                                                                                              &#13;&#10;&boxdr;&HorizontalLine;&HorizontalLine;(kali&#12927;kali)-[~/Documents/VulnHub/TommyBoy_1/nmap]&#13;&#10;&boxur;&HorizontalLine;$ exiftool shockedrichard.jpg                                                             &#13;&#10;ExifTool Version Number         : 12.30&#13;&#10;File Name                       : shockedrichard.jpg&#13;&#10;Directory                       : .&#13;&#10;File Size                       : 163 KiB&#13;&#10;File Modification Date/Time     : 2016:07:07 15:17:24-04:00&#13;&#10;File Access Date/Time           : 2021:09:27 18:38:09-04:00&#13;&#10;File Inode Change Date/Time     : 2021:09:27 18:38:09-04:00&#13;&#10;File Permissions                : -rw-r--r--&#13;&#10;File Type                       : JPEG&#13;&#10;File Type Extension             : jpg&#13;&#10;MIME Type                       : image/jpeg&#13;&#10;JFIF Version                    : 1.01&#13;&#10;Resolution Unit                 : None&#13;&#10;X Resolution                    : 1&#13;&#10;Y Resolution                    : 1&#13;&#10;Exif Byte Order                 : Little-endian (Intel, II)&#13;&#10;Software                        : Google&#13;&#10;Copyright                       : Copyright &copy; 1995 Paramount Pictures Corporation. Credit: &copy; 1995 Paramount Pictures / Courtesy: Pyxurz.&#13;&#10;Exif Version                    : 0220&#13;&#10;<marK>User Comment                    : ce154b5a8e59c89732bc25d6a2e6b90b</marK>
Exif Image Width                : 1600&#13;&#10;Exif Image Height               : 1029&#13;&#10;XMP Toolkit                     : Image::ExifTool 9.97&#13;&#10;Rights                          : Copyright &copy; 1995 Paramount Pictures Corporation. Credit: &copy; 1995 Paramount Pictures / Courtesy: Pyxurz.&#13;&#10;Creator Tool                    : Google&#13;&#10;Profile CMM Type                : Linotronic&#13;&#10;Profile Version                 : 2.1.0&#13;&#10;Profile Class                   : Display Device Profile&#13;&#10;Color Space Data                : RGB&#13;&#10;Profile Connection Space        : XYZ&#13;&#10;Profile Date Time               : 1998:02:09 06:49:00&#13;&#10;Profile File Signature          : acsp&#13;&#10;Primary Platform                : Microsoft Corporation&#13;&#10;CMM Flags                       : Not Embedded, Independent&#13;&#10;Device Manufacturer             : Hewlett-Packard&#13;&#10;Device Model                    : sRGB&#13;&#10;Device Attributes               : Reflective, Glossy, Positive, Color&#13;&#10;Rendering Intent                : Media-Relative Colorimetric&#13;&#10;Connection Space Illuminant     : 0.9642 1 0.82491&#13;&#10;Profile Creator                 : Hewlett-Packard&#13;&#10;Profile ID                      : 0&#13;&#10;Profile Copyright               : Copyright (c) 1998 Hewlett-Packard Company&#13;&#10;Profile Description             : sRGB IEC61966-2.1&#13;&#10;Media White Point               : 0.95045 1 1.08905&#13;&#10;Media Black Point               : 0 0 0&#13;&#10;Red Matrix Column               : 0.43607 0.22249 0.01392&#13;&#10;Green Matrix Column             : 0.38515 0.71687 0.09708&#13;&#10;Blue Matrix Column              : 0.14307 0.06061 0.7141&#13;&#10;Device Mfg Desc                 : IEC http://www.iec.ch&#13;&#10;Device Model Desc               : IEC 61966-2.1 Default RGB colour space - sRGB&#13;&#10;Viewing Cond Desc               : Reference Viewing Condition in IEC61966-2.1&#13;&#10;Viewing Cond Illuminant         : 19.6445 20.3718 16.8089&#13;&#10;Viewing Cond Surround           : 3.92889 4.07439 3.36179&#13;&#10;Viewing Cond Illuminant Type    : D50&#13;&#10;Luminance                       : 76.03647 80 87.12462&#13;&#10;Measurement Observer            : CIE 1931&#13;&#10;Measurement Backing             : 0 0 0&#13;&#10;Measurement Geometry            : Unknown&#13;&#10;Measurement Flare               : 0.999%&#13;&#10;Measurement Illuminant          : D65&#13;&#10;Technology                      : Cathode Ray Tube Display&#13;&#10;Red Tone Reproduction Curve     : (Binary data 2060 bytes, use -b option to extract)&#13;&#10;Green Tone Reproduction Curve   : (Binary data 2060 bytes, use -b option to extract)&#13;&#10;Blue Tone Reproduction Curve    : (Binary data 2060 bytes, use -b option to extract)&#13;&#10;Current IPTC Digest             : adfc7551120fa16884c295b6d397931f&#13;&#10;Envelope Record Version         : 4&#13;&#10;Coded Character Set             : UTF8&#13;&#10;Application Record Version      : 4&#13;&#10;Copyright Notice                : Copyright &copy; 1995 Paramount Pictures Corporation. Credit: &copy; 1995 Paramount Pictures / Courtesy: Pyxurz.&#13;&#10;IPTC Digest                     : adfc7551120fa16884c295b6d397931f&#13;&#10;Image Width                     : 1600&#13;&#10;Image Height                    : 1029&#13;&#10;Encoding Process                : Baseline DCT, Huffman coding&#13;&#10;Bits Per Sample                 : 8&#13;&#10;Color Components                : 3&#13;&#10;Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)&#13;&#10;Image Size                      : 1600x1029&#13;&#10;Megapixels                      : 1.6
    </pre>

    <li>The "User Comment" looks like a md5 hash so I crack it with hashcat and find out that the password is "spanky".  Now we can look at the password protected post on this page - http://10.0.0.22/prehistoricforest/index.php/2016/07/06/status-of-restoring-company-home-page/.</li>

    <li>We learn a few things from this post</li>
    <ul>
        <li>There is a backup of the web page called callahanbak.bak that we can change to index.html and the website will be up and running again.</li>
        <ul>
            <li>We must SSH in under Big Tom's account to do this.</li>
            <ul>
                <li>Big Tom's account is not accurately named, so we will need to find out his account name.</li>
                <ul>
                    <li>We can find his account name by looking at the list of users on the system.  Not sure where to find this at this point.</li>
                </ul>
            </ul>
        </ul>
        <li>The FTP server will have useful information for us.</li>
        <ul>
            <li>The FTP server is flakey.  It supposedly turns off and on every 15 minutes.</li>
            <li>It is running on a random port number.  We already have enumerated this.</li>
            <li>The account name is nickburns</li>
            <li>The password is supposed to be very easy to guess.</li>
        </ul>
    </ul>

    <li>First I login the the FTP server.  The credentials turn out to be nickburns:nickburns.  On the FTP server is file named readme.txt.  I download it.  It reveals a directory that works as a dropbox named "NickIzL33t".  Big Tom's passwords are in there.</li>
    <br>
    <h2><a id="foothold">Foothold</a></h2>


    <br>
    <h2><a id="root">Privesc - Root</a></h2>

</body>
</html>

